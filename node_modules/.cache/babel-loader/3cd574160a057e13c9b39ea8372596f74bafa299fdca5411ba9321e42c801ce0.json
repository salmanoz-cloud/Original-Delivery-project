{"ast":null,"code":"import React,{useState,useEffect,useCallback}from'react';import{useNavigate}from'react-router-dom';import{useAuth}from'../contexts/AuthContext';import{getPackages,getFamilyMembers,getSubscriptionByUserId,updatePackageStatus}from'../services/firestoreService';import AddPackageModal from'../components/AddPackageModal';import AddFamilyMemberModal from'../components/AddFamilyMemberModal';import PackagesList from'../components/PackagesList';import SubscriptionCard from'../components/SubscriptionCard';import'../styles/CustomerDashboard.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function CustomerDashboard(){const{user,userRole,loading}=useAuth();const navigate=useNavigate();const[packages,setPackages]=useState([]);const[familyMembers,setFamilyMembers]=useState([]);const[subscription,setSubscription]=useState(null);const[isAddPackageModalOpen,setIsAddPackageModalOpen]=useState(false);const[isAddFamilyMemberModalOpen,setIsAddFamilyMemberModalOpen]=useState(false);useEffect(()=>{if(!loading&&(!user||userRole!=='customer')){navigate('/login');}if(user){fetchCustomerData();}},[user,userRole,loading,navigate,fetchCustomerData]);const fetchCustomerData=async()=>{const userPackagesResult=await getPackages(user.uid,null);if(userPackagesResult.success){setPackages(userPackagesResult.data);}else{console.error(\"Error fetching packages:\",userPackagesResult.error);setPackages([]);}const userFamilyMembersResult=await getFamilyMembers(user.uid);if(userFamilyMembersResult.success){setFamilyMembers(userFamilyMembersResult.data);}else{console.error(\"Error fetching family members:\",userFamilyMembersResult.error);setFamilyMembers([]);}const userSubscriptionResult=await getSubscriptionByUserId(user.uid);if(userSubscriptionResult.success){setSubscription(userSubscriptionResult.data);}else{console.error(\"Error fetching subscription:\",userSubscriptionResult.error);setSubscription(null);}};const handleUpdatePackageStatus=async(packageId,newStatus)=>{await updatePackageStatus(packageId,newStatus);fetchCustomerData();};const handleLogout=async()=>{// Implement logout logic here if needed, though typically handled in AuthContext or main App\nnavigate('/login');};if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"customer-dashboard\",children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Welcome, \",user===null||user===void 0?void 0:user.email,\" (Customer)\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsAddPackageModalOpen(true),children:\"Add New Package\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsAddFamilyMemberModalOpen(true),children:\"Add Family Member\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,children:\"Logout\"}),/*#__PURE__*/_jsx(SubscriptionCard,{subscription:subscription}),/*#__PURE__*/_jsx(PackagesList,{packages:packages,onUpdateStatus:handleUpdatePackageStatus}),/*#__PURE__*/_jsx(AddPackageModal,{isOpen:isAddPackageModalOpen,onClose:()=>setIsAddPackageModalOpen(false),onPackageAdded:fetchCustomerData}),/*#__PURE__*/_jsx(AddFamilyMemberModal,{isOpen:isAddFamilyMemberModalOpen,onClose:()=>setIsAddFamilyMemberModalOpen(false),onFamilyMemberAdded:fetchCustomerData})]});}export default CustomerDashboard;","map":{"version":3,"names":["React","useState","useEffect","useCallback","useNavigate","useAuth","getPackages","getFamilyMembers","getSubscriptionByUserId","updatePackageStatus","AddPackageModal","AddFamilyMemberModal","PackagesList","SubscriptionCard","jsx","_jsx","jsxs","_jsxs","CustomerDashboard","user","userRole","loading","navigate","packages","setPackages","familyMembers","setFamilyMembers","subscription","setSubscription","isAddPackageModalOpen","setIsAddPackageModalOpen","isAddFamilyMemberModalOpen","setIsAddFamilyMemberModalOpen","fetchCustomerData","userPackagesResult","uid","success","data","console","error","userFamilyMembersResult","userSubscriptionResult","handleUpdatePackageStatus","packageId","newStatus","handleLogout","children","className","email","onClick","onUpdateStatus","isOpen","onClose","onPackageAdded","onFamilyMemberAdded"],"sources":["/home/ubuntu/personal-delivery-app/src/customer-app/CustomerDashboard.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../contexts/AuthContext';\nimport { getPackages, getFamilyMembers, getSubscriptionByUserId, updatePackageStatus } from '../services/firestoreService';\nimport AddPackageModal from '../components/AddPackageModal';\nimport AddFamilyMemberModal from '../components/AddFamilyMemberModal';\nimport PackagesList from '../components/PackagesList';\nimport SubscriptionCard from '../components/SubscriptionCard';\nimport '../styles/CustomerDashboard.css';\n\nfunction CustomerDashboard() {\n  const { user, userRole, loading } = useAuth();\n  const navigate = useNavigate();\n  const [packages, setPackages] = useState([]);\n  const [familyMembers, setFamilyMembers] = useState([]);\n  const [subscription, setSubscription] = useState(null);\n  const [isAddPackageModalOpen, setIsAddPackageModalOpen] = useState(false);\n  const [isAddFamilyMemberModalOpen, setIsAddFamilyMemberModalOpen] = useState(false);\n\n  useEffect(() => {\n    if (!loading && (!user || userRole !== 'customer')) {\n      navigate('/login');\n    }\n\n    if (user) {\n      fetchCustomerData();\n    }\n  }, [user, userRole, loading, navigate, fetchCustomerData]);\n\n  const fetchCustomerData = async () => {\n    const userPackagesResult = await getPackages(user.uid, null);\n    if (userPackagesResult.success) {\n      setPackages(userPackagesResult.data);\n    } else {\n      console.error(\"Error fetching packages:\", userPackagesResult.error);\n      setPackages([]);\n    }\n\n    const userFamilyMembersResult = await getFamilyMembers(user.uid);\n    if (userFamilyMembersResult.success) {\n      setFamilyMembers(userFamilyMembersResult.data);\n    } else {\n      console.error(\"Error fetching family members:\", userFamilyMembersResult.error);\n      setFamilyMembers([]);\n    }\n\n    const userSubscriptionResult = await getSubscriptionByUserId(user.uid);\n    if (userSubscriptionResult.success) {\n      setSubscription(userSubscriptionResult.data);\n    } else {\n      console.error(\"Error fetching subscription:\", userSubscriptionResult.error);\n      setSubscription(null);\n    }\n  };\n\n  const handleUpdatePackageStatus = async (packageId, newStatus) => {\n    await updatePackageStatus(packageId, newStatus);\n    fetchCustomerData();\n  };\n\n  const handleLogout = async () => {\n    // Implement logout logic here if needed, though typically handled in AuthContext or main App\n    navigate('/login');\n  };\n\n  if (loading) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <div className=\"customer-dashboard\">\n      <h1>Welcome, {user?.email} (Customer)</h1>\n      <button onClick={() => setIsAddPackageModalOpen(true)}>Add New Package</button>\n      <button onClick={() => setIsAddFamilyMemberModalOpen(true)}>Add Family Member</button>\n      <button onClick={handleLogout}>Logout</button>\n\n      <SubscriptionCard subscription={subscription} />\n      <PackagesList packages={packages} onUpdateStatus={handleUpdatePackageStatus} />\n\n      <AddPackageModal\n        isOpen={isAddPackageModalOpen}\n        onClose={() => setIsAddPackageModalOpen(false)}\n        onPackageAdded={fetchCustomerData}\n      />\n      <AddFamilyMemberModal\n        isOpen={isAddFamilyMemberModalOpen}\n        onClose={() => setIsAddFamilyMemberModalOpen(false)}\n        onFamilyMemberAdded={fetchCustomerData}\n      />\n    </div>\n  );\n}\n\nexport default CustomerDashboard;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}