{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{useAuth}from'../contexts/AuthContext';import{getPackages,getFamilyMembers,getSubscriptionByUserId,updatePackageStatus}from'../services/firestoreService';import AddPackageModal from'../components/AddPackageModal';import AddFamilyMemberModal from'../components/AddFamilyMemberModal';import PackagesList from'../components/PackagesList';import SubscriptionCard from'../components/SubscriptionCard';import'../styles/CustomerDashboard.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function CustomerDashboard(){const{user,userRole,loading}=useAuth();const navigate=useNavigate();const[packages,setPackages]=useState([]);const[familyMembers,setFamilyMembers]=useState([]);const[subscription,setSubscription]=useState(null);const[isAddPackageModalOpen,setIsAddPackageModalOpen]=useState(false);const[isAddFamilyMemberModalOpen,setIsAddFamilyMemberModalOpen]=useState(false);useEffect(()=>{if(!loading&&(!user||userRole!=='customer')){navigate('/login');}if(user){fetchCustomerData();}},[user,userRole,loading,navigate]);const fetchCustomerData=async()=>{const userPackages=await getPackages(user.uid,null);setPackages(userPackages);const userFamilyMembers=await getFamilyMembers(user.uid);setFamilyMembers(userFamilyMembers);const userSubscription=await getSubscriptionByUserId(user.uid);setSubscription(userSubscription);};const handleUpdatePackageStatus=async(packageId,newStatus)=>{await updatePackageStatus(packageId,newStatus);fetchCustomerData();};const handleLogout=async()=>{// Implement logout logic here if needed, though typically handled in AuthContext or main App\nnavigate('/login');};if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"customer-dashboard\",children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Welcome, \",user===null||user===void 0?void 0:user.email,\" (Customer)\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsAddPackageModalOpen(true),children:\"Add New Package\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsAddFamilyMemberModalOpen(true),children:\"Add Family Member\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,children:\"Logout\"}),/*#__PURE__*/_jsx(SubscriptionCard,{subscription:subscription}),/*#__PURE__*/_jsx(PackagesList,{packages:packages,onUpdateStatus:handleUpdatePackageStatus}),/*#__PURE__*/_jsx(AddPackageModal,{isOpen:isAddPackageModalOpen,onClose:()=>setIsAddPackageModalOpen(false),onPackageAdded:fetchCustomerData}),/*#__PURE__*/_jsx(AddFamilyMemberModal,{isOpen:isAddFamilyMemberModalOpen,onClose:()=>setIsAddFamilyMemberModalOpen(false),onFamilyMemberAdded:fetchCustomerData})]});}export default CustomerDashboard;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","useAuth","getPackages","getFamilyMembers","getSubscriptionByUserId","updatePackageStatus","AddPackageModal","AddFamilyMemberModal","PackagesList","SubscriptionCard","jsx","_jsx","jsxs","_jsxs","CustomerDashboard","user","userRole","loading","navigate","packages","setPackages","familyMembers","setFamilyMembers","subscription","setSubscription","isAddPackageModalOpen","setIsAddPackageModalOpen","isAddFamilyMemberModalOpen","setIsAddFamilyMemberModalOpen","fetchCustomerData","userPackages","uid","userFamilyMembers","userSubscription","handleUpdatePackageStatus","packageId","newStatus","handleLogout","children","className","email","onClick","onUpdateStatus","isOpen","onClose","onPackageAdded","onFamilyMemberAdded"],"sources":["/home/ubuntu/personal-delivery-app/src/customer-app/CustomerDashboard.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useAuth } from '../contexts/AuthContext';\nimport { getPackages, getFamilyMembers, getSubscriptionByUserId, updatePackageStatus } from '../services/firestoreService';\nimport AddPackageModal from '../components/AddPackageModal';\nimport AddFamilyMemberModal from '../components/AddFamilyMemberModal';\nimport PackagesList from '../components/PackagesList';\nimport SubscriptionCard from '../components/SubscriptionCard';\nimport '../styles/CustomerDashboard.css';\n\nfunction CustomerDashboard() {\n  const { user, userRole, loading } = useAuth();\n  const navigate = useNavigate();\n  const [packages, setPackages] = useState([]);\n  const [familyMembers, setFamilyMembers] = useState([]);\n  const [subscription, setSubscription] = useState(null);\n  const [isAddPackageModalOpen, setIsAddPackageModalOpen] = useState(false);\n  const [isAddFamilyMemberModalOpen, setIsAddFamilyMemberModalOpen] = useState(false);\n\n  useEffect(() => {\n    if (!loading && (!user || userRole !== 'customer')) {\n      navigate('/login');\n    }\n\n    if (user) {\n      fetchCustomerData();\n    }\n  }, [user, userRole, loading, navigate]);\n\n  const fetchCustomerData = async () => {\n    const userPackages = await getPackages(user.uid, null);\n    setPackages(userPackages);\n\n    const userFamilyMembers = await getFamilyMembers(user.uid);\n    setFamilyMembers(userFamilyMembers);\n\n    const userSubscription = await getSubscriptionByUserId(user.uid);\n    setSubscription(userSubscription);\n  };\n\n  const handleUpdatePackageStatus = async (packageId, newStatus) => {\n    await updatePackageStatus(packageId, newStatus);\n    fetchCustomerData();\n  };\n\n  const handleLogout = async () => {\n    // Implement logout logic here if needed, though typically handled in AuthContext or main App\n    navigate('/login');\n  };\n\n  if (loading) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <div className=\"customer-dashboard\">\n      <h1>Welcome, {user?.email} (Customer)</h1>\n      <button onClick={() => setIsAddPackageModalOpen(true)}>Add New Package</button>\n      <button onClick={() => setIsAddFamilyMemberModalOpen(true)}>Add Family Member</button>\n      <button onClick={handleLogout}>Logout</button>\n\n      <SubscriptionCard subscription={subscription} />\n      <PackagesList packages={packages} onUpdateStatus={handleUpdatePackageStatus} />\n\n      <AddPackageModal\n        isOpen={isAddPackageModalOpen}\n        onClose={() => setIsAddPackageModalOpen(false)}\n        onPackageAdded={fetchCustomerData}\n      />\n      <AddFamilyMemberModal\n        isOpen={isAddFamilyMemberModalOpen}\n        onClose={() => setIsAddFamilyMemberModalOpen(false)}\n        onFamilyMemberAdded={fetchCustomerData}\n      />\n    </div>\n  );\n}\n\nexport default CustomerDashboard;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}