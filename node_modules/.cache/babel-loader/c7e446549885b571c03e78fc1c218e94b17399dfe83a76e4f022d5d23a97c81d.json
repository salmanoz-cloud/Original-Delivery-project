{"ast":null,"code":"import React,{useState,useEffect}from'react';import{getSubscriptionByFamilyId,getServicePackages}from'../services/firestoreService';import'../styles/SubscriptionCard.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function SubscriptionCard(_ref){let{familyId,onUpgrade}=_ref;const[subscription,setSubscription]=useState(null);const[servicePackages,setServicePackages]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');useEffect(()=>{const fetchData=async()=>{setLoading(true);setError('');try{const subResult=await getSubscriptionByFamilyId(familyId);if(subResult.success){setSubscription(subResult.data);}const spResult=await getServicePackages();if(spResult.success){setServicePackages(spResult.data.sort((a,b)=>a.packageCount-b.packageCount));}}catch(err){setError('שגיאה בטעינת נתוני מנוי: '+err.message);}setLoading(false);};if(familyId){fetchData();}},[familyId]);if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"\\u05D8\\u05D5\\u05E2\\u05DF \\u05DE\\u05E0\\u05D5\\u05D9...\"});}if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-error\",children:[\"\\u05E9\\u05D2\\u05D9\\u05D0\\u05D4: \",error]});}const currentPackage=subscription?servicePackages.find(sp=>sp.id===subscription.servicePackageId):null;const remainingPackages=subscription?currentPackage?currentPackage.packageCount-subscription.packagesUsed:0:0;return/*#__PURE__*/_jsxs(\"div\",{className:\"subscription-card card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\u05D4\\u05DE\\u05E0\\u05D5\\u05D9 \\u05E9\\u05DC\\u05D9\"}),subscription?/*#__PURE__*/_jsxs(\"div\",{className:\"subscription-details\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u05D7\\u05D1\\u05D9\\u05DC\\u05D4 \\u05E0\\u05D5\\u05DB\\u05D7\\u05D9\\u05EA:\"}),\" \",(currentPackage===null||currentPackage===void 0?void 0:currentPackage.name)||'לא ידוע']}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u05D7\\u05D1\\u05D9\\u05DC\\u05D5\\u05EA \\u05E9\\u05E0\\u05D5\\u05E6\\u05DC\\u05D5 \\u05D4\\u05D7\\u05D5\\u05D3\\u05E9:\"}),\" \",subscription.packagesUsed]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u05D7\\u05D1\\u05D9\\u05DC\\u05D5\\u05EA \\u05E9\\u05E0\\u05D5\\u05EA\\u05E8\\u05D5:\"}),\" \",remainingPackages]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u05EA\\u05D0\\u05E8\\u05D9\\u05DA \\u05D7\\u05D9\\u05D3\\u05D5\\u05E9:\"}),\" \",new Date(subscription.renewalDate.seconds*1000).toLocaleDateString()]}),/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar\",style:{width:\"\".concat(subscription.packagesUsed/(currentPackage===null||currentPackage===void 0?void 0:currentPackage.packageCount)*100||0,\"%\")}})}),/*#__PURE__*/_jsxs(\"p\",{className:\"progress-text\",children:[subscription.packagesUsed,\" \\u05DE\\u05EA\\u05D5\\u05DA \",(currentPackage===null||currentPackage===void 0?void 0:currentPackage.packageCount)||0,\" \\u05D7\\u05D1\\u05D9\\u05DC\\u05D5\\u05EA \\u05E0\\u05D5\\u05E6\\u05DC\\u05D5\"]})]}):/*#__PURE__*/_jsx(\"p\",{children:\"\\u05D0\\u05D9\\u05DF \\u05DC\\u05DA \\u05DE\\u05E0\\u05D5\\u05D9 \\u05E4\\u05E2\\u05D9\\u05DC \\u05DB\\u05E8\\u05D2\\u05E2. \\u05D1\\u05D7\\u05E8 \\u05D7\\u05D1\\u05D9\\u05DC\\u05D4 \\u05DB\\u05D3\\u05D9 \\u05DC\\u05D4\\u05EA\\u05D7\\u05D9\\u05DC!\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"service-packages-list\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"\\u05D1\\u05D7\\u05E8 \\u05D7\\u05D1\\u05D9\\u05DC\\u05D4:\"}),servicePackages.map(sp=>/*#__PURE__*/_jsxs(\"div\",{className:\"service-package-option \".concat((subscription===null||subscription===void 0?void 0:subscription.servicePackageId)===sp.id?'active':''),children:[/*#__PURE__*/_jsxs(\"span\",{children:[sp.name,\" (\",sp.packageCount,\" \\u05D7\\u05D1\\u05D9\\u05DC\\u05D5\\u05EA) - \",sp.price,\" \\u05E9\\\"\\u05D7\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"button button-primary\",onClick:()=>onUpgrade(sp.id),disabled:(subscription===null||subscription===void 0?void 0:subscription.servicePackageId)===sp.id,children:(subscription===null||subscription===void 0?void 0:subscription.servicePackageId)===sp.id?'נוכחי':'בחר'})]},sp.id))]})]});}export default SubscriptionCard;","map":{"version":3,"names":["React","useState","useEffect","getSubscriptionByFamilyId","getServicePackages","jsx","_jsx","jsxs","_jsxs","SubscriptionCard","_ref","familyId","onUpgrade","subscription","setSubscription","servicePackages","setServicePackages","loading","setLoading","error","setError","fetchData","subResult","success","data","spResult","sort","a","b","packageCount","err","message","className","children","currentPackage","find","sp","id","servicePackageId","remainingPackages","packagesUsed","name","Date","renewalDate","seconds","toLocaleDateString","style","width","concat","map","price","onClick","disabled"],"sources":["/home/ubuntu/personal-delivery-app/src/components/SubscriptionCard.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { getSubscriptionByFamilyId, getServicePackages } from '../services/firestoreService';\nimport '../styles/SubscriptionCard.css';\n\nfunction SubscriptionCard({ familyId, onUpgrade }) {\n  const [subscription, setSubscription] = useState(null);\n  const [servicePackages, setServicePackages] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n\n  useEffect(() => {\n    const fetchData = async () => {\n      setLoading(true);\n      setError('');\n      try {\n        const subResult = await getSubscriptionByFamilyId(familyId);\n        if (subResult.success) {\n          setSubscription(subResult.data);\n        }\n\n        const spResult = await getServicePackages();\n        if (spResult.success) {\n          setServicePackages(spResult.data.sort((a, b) => a.packageCount - b.packageCount));\n        }\n      } catch (err) {\n        setError('שגיאה בטעינת נתוני מנוי: ' + err.message);\n      }\n      setLoading(false);\n    };\n\n    if (familyId) {\n      fetchData();\n    }\n  }, [familyId]);\n\n  if (loading) {\n    return <div className=\"loading\">טוען מנוי...</div>;\n  }\n\n  if (error) {\n    return <div className=\"alert alert-error\">שגיאה: {error}</div>;\n  }\n\n  const currentPackage = subscription ? servicePackages.find(sp => sp.id === subscription.servicePackageId) : null;\n  const remainingPackages = subscription ? (currentPackage ? currentPackage.packageCount - subscription.packagesUsed : 0) : 0;\n\n  return (\n    <div className=\"subscription-card card\">\n      <h3>המנוי שלי</h3>\n      {subscription ? (\n        <div className=\"subscription-details\">\n          <p><strong>חבילה נוכחית:</strong> {currentPackage?.name || 'לא ידוע'}</p>\n          <p><strong>חבילות שנוצלו החודש:</strong> {subscription.packagesUsed}</p>\n          <p><strong>חבילות שנותרו:</strong> {remainingPackages}</p>\n          <p><strong>תאריך חידוש:</strong> {new Date(subscription.renewalDate.seconds * 1000).toLocaleDateString()}</p>\n          <div className=\"progress-bar-container\">\n            <div\n              className=\"progress-bar\"\n              style={{ width: `${(subscription.packagesUsed / currentPackage?.packageCount) * 100 || 0}%` }}\n            ></div>\n          </div>\n          <p className=\"progress-text\">{subscription.packagesUsed} מתוך {currentPackage?.packageCount || 0} חבילות נוצלו</p>\n        </div>\n      ) : (\n        <p>אין לך מנוי פעיל כרגע. בחר חבילה כדי להתחיל!</p>\n      )}\n\n      <div className=\"service-packages-list\">\n        <h4>בחר חבילה:</h4>\n        {servicePackages.map((sp) => (\n          <div key={sp.id} className={`service-package-option ${subscription?.servicePackageId === sp.id ? 'active' : ''}`}>\n            <span>{sp.name} ({sp.packageCount} חבילות) - {sp.price} ש\"ח</span>\n            <button\n              className=\"button button-primary\"\n              onClick={() => onUpgrade(sp.id)}\n              disabled={subscription?.servicePackageId === sp.id}\n            >\n              {subscription?.servicePackageId === sp.id ? 'נוכחי' : 'בחר'}\n            </button>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n\nexport default SubscriptionCard;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}